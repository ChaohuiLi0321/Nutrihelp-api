
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>NutriHelp Security Scanner V2.0 Report</title>
        <style>
            * { margin: 0; padding: 0; box-sizing: border-box; }
            body { 
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
                margin: 20px; background: #f5f5f5; line-height: 1.6;
            }
            .container { 
                max-width: 1200px; margin: 0 auto; background: white; 
                border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); overflow: hidden;
            }
            .header { 
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
                color: white; padding: 30px; text-align: center;
            }
            .header h1 { font-size: 2.5rem; margin-bottom: 10px; }
            .header .meta { opacity: 0.9; font-size: 1.1rem; }
            
            .summary { 
                padding: 30px; background: #f8f9fa; 
                display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
                gap: 20px; border-bottom: 2px solid #e9ecef;
            }
            .summary-card { 
                background: white; padding: 25px; border-radius: 10px; text-align: center; 
                box-shadow: 0 2px 4px rgba(0,0,0,0.1); border-left: 4px solid;
            }
            .summary-card.critical { border-left-color: #dc3545; }
            .summary-card.high { border-left-color: #fd7e14; }
            .summary-card.medium { border-left-color: #ffc107; }
            .summary-card.low { border-left-color: #28a745; }
            .summary-card h3 { font-size: 2rem; margin-bottom: 10px; }
            .summary-card p { color: #6c757d; font-weight: 500; }
            
            .content { padding: 30px; }
            .section-title { 
                font-size: 1.8rem; color: #2c3e50; margin: 30px 0 20px 0; 
                border-bottom: 2px solid #3498db; padding-bottom: 10px;
            }
            
            .finding { 
                margin: 20px 0; padding: 25px; border: 1px solid #dee2e6; 
                border-radius: 10px; transition: transform 0.2s ease;
            }
            .finding:hover { transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
            .finding.critical { border-left: 5px solid #dc3545; background: #fdf2f2; }
            .finding.high { border-left: 5px solid #fd7e14; background: #fef8f3; }
            .finding.medium { border-left: 5px solid #ffc107; background: #fffdf0; }
            .finding.low { border-left: 5px solid #28a745; background: #f0f9f0; }
            
            .finding-header { display: flex; justify-content: between; align-items: center; margin-bottom: 15px; }
            .finding-title { font-size: 1.3rem; font-weight: bold; color: #2c3e50; }
            .severity { 
                display: inline-block; padding: 6px 12px; border-radius: 20px; 
                font-size: 0.8rem; font-weight: bold; text-transform: uppercase;
            }
            .severity.critical { background: #dc3545; color: white; }
            .severity.high { background: #fd7e14; color: white; }
            .severity.medium { background: #ffc107; color: black; }
            .severity.low { background: #28a745; color: white; }
            
            .file-info { 
                background: #f8f9fa; padding: 10px 15px; border-radius: 6px; 
                font-family: 'Courier New', monospace; font-size: 0.9rem; margin: 10px 0;
            }
            .description { color: #495057; margin: 15px 0; }
            .recommendation { 
                background: #e3f2fd; border-left: 4px solid #2196f3; padding: 15px; 
                border-radius: 4px; margin-top: 15px;
            }
            .recommendation strong { color: #1976d2; }
            
            .no-issues { 
                text-align: center; padding: 60px; color: #28a745; 
                background: #f0f9f0; border-radius: 10px; margin: 20px 0;
            }
            .no-issues h2 { font-size: 2rem; margin-bottom: 10px; }
            
            .footer { 
                background: #2c3e50; color: white; text-align: center; 
                padding: 20px; margin-top: 30px;
            }
            .footer a { color: #3498db; text-decoration: none; }
            .footer a:hover { text-decoration: underline; }
            
            .stats { 
                background: #e8f4fd; padding: 20px; border-radius: 8px; 
                margin: 20px 0; display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); 
                gap: 15px;
            }
            .stat-item { text-align: center; }
            .stat-number { font-size: 1.5rem; font-weight: bold; color: #2c3e50; }
            .stat-label { color: #6c757d; font-size: 0.9rem; }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="header">
                <h1>üîí NutriHelp Security Scanner V2.0</h1>
                <div class="meta">
                    <p><strong>Scan time:</strong> 2025-09-05 23:44:45</p>
                    <p><strong>Target path:</strong> ../</p>
                    <p><strong>Scanner version:</strong> 2.0.0</p>
                </div>
            </div>
            
            <div class="summary">
                <div class="summary-card critical">
                    <h3>2</h3>
                    <p>Critical Issues</p>
                </div>
                <div class="summary-card high">
                    <h3>16</h3>
                    <p>High Severity</p>
                </div>
                <div class="summary-card medium">
                    <h3>10</h3>
                    <p>Medium Severity</p>
                </div>
                <div class="summary-card low">
                    <h3>1</h3>
                    <p>Low Severity</p>
                </div>
            </div>
            
            <div class="content">
                <div class="stats">
                    <div class="stat-item">
                        <div class="stat-number">840</div>
                        <div class="stat-label">Files Scanned</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">2</div>
                        <div class="stat-label">Plugins Used</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">29</div>
                        <div class="stat-label">Total Issues</div>
                    </div>
                </div>
                
                <h2 class="section-title">üîç Detailed Findings</h2>
            <div class="finding critical">
                <div class="finding-header">
                    <div class="finding-title">Missing JWT Protection: PUT /update-by-identifier</div>
                    <span class="severity critical">CRITICAL</span>
                </div>
                
                <div class="file-info">
                    üìÅ routes/userprofile.js
                     (Line 14)
                </div>
                
                <div class="description">API endpoint PUT /update-by-identifier in userprofile.js lacks JWT authentication middleware. Based on your current architecture, this should use authenticateToken middleware.</div>
                
                <div class="recommendation">
                    <strong>üí° Recommendation:</strong> To fix this JWT protection issue, add the authenticateToken middleware:

1. Import the middleware (if not already imported):
   const { authenticateToken } = require('../middleware/authenticateToken');

2. Add middleware to the route:
   router.put('/update-by-identifier', authenticateToken, (req, res) => { ... });
   
   Or if using a controller:
   router.put('/update-by-identifier', authenticateToken, controllerFunction);

3. For optional authentication, you can use:
   const { optionalAuth } = require('../middleware/authenticateToken');
   router.put('/update-by-identifier', optionalAuth, (req, res) => { ... });

4. Your current JWT setup uses:
   - Access tokens (15 minutes expiry)
   - Refresh tokens (7 days expiry) 
   - Proper error handling with specific error codes

Example based on your auth.js pattern:
router.put('/update-by-identifier', authenticateToken, controllerFunction);
                </div>
                
                <div style='margin-top: 10px; font-size: 0.9rem; color: #6c757d;'>Plugin: JWTMissingProtectionPlugin</div>
            </div>
            
            <div class="finding critical">
                <div class="finding-header">
                    <div class="finding-title">Missing JWT Protection: PUT /update-by-identifier</div>
                    <span class="severity critical">CRITICAL</span>
                </div>
                
                <div class="file-info">
                    üìÅ routes/userprofile.js
                     (Line 14)
                </div>
                
                <div class="description">API endpoint PUT /update-by-identifier in userprofile.js lacks JWT authentication middleware. Based on your current architecture, this should use authenticateToken middleware.</div>
                
                <div class="recommendation">
                    <strong>üí° Recommendation:</strong> To fix this JWT protection issue, add the authenticateToken middleware:

1. Import the middleware (if not already imported):
   const { authenticateToken } = require('../middleware/authenticateToken');

2. Add middleware to the route:
   router.put('/update-by-identifier', authenticateToken, (req, res) => { ... });
   
   Or if using a controller:
   router.put('/update-by-identifier', authenticateToken, controllerFunction);

3. For optional authentication, you can use:
   const { optionalAuth } = require('../middleware/authenticateToken');
   router.put('/update-by-identifier', optionalAuth, (req, res) => { ... });

4. Your current JWT setup uses:
   - Access tokens (15 minutes expiry)
   - Refresh tokens (7 days expiry) 
   - Proper error handling with specific error codes

Example based on your auth.js pattern:
router.put('/update-by-identifier', authenticateToken, controllerFunction);
                </div>
                
                <div style='margin-top: 10px; font-size: 0.9rem; color: #6c757d;'>Plugin: JWTMissingProtectionPlugin</div>
            </div>
            
            <div class="finding high">
                <div class="finding-header">
                    <div class="finding-title">Missing JWT Protection: POST /</div>
                    <span class="severity high">HIGH</span>
                </div>
                
                <div class="file-info">
                    üìÅ routes/imageClassification.js
                     (Line 19)
                </div>
                
                <div class="description">API endpoint POST / in imageClassification.js lacks JWT authentication middleware. Based on your current architecture, this should use authenticateToken middleware.</div>
                
                <div class="recommendation">
                    <strong>üí° Recommendation:</strong> To fix this JWT protection issue, add the authenticateToken middleware:

1. Import the middleware (if not already imported):
   const { authenticateToken } = require('../middleware/authenticateToken');

2. Add middleware to the route:
   router.post('/', authenticateToken, (req, res) => { ... });
   
   Or if using a controller:
   router.post('/', authenticateToken, controllerFunction);

3. For optional authentication, you can use:
   const { optionalAuth } = require('../middleware/authenticateToken');
   router.post('/', optionalAuth, (req, res) => { ... });

4. Your current JWT setup uses:
   - Access tokens (15 minutes expiry)
   - Refresh tokens (7 days expiry) 
   - Proper error handling with specific error codes

Example based on your auth.js pattern:
router.post('/', authenticateToken, controllerFunction);
                </div>
                
                <div style='margin-top: 10px; font-size: 0.9rem; color: #6c757d;'>Plugin: JWTMissingProtectionPlugin</div>
            </div>
            
            <div class="finding high">
                <div class="finding-header">
                    <div class="finding-title">Missing JWT Protection: POST /</div>
                    <span class="severity high">HIGH</span>
                </div>
                
                <div class="file-info">
                    üìÅ routes/upload.js
                     (Line 5)
                </div>
                
                <div class="description">API endpoint POST / in upload.js lacks JWT authentication middleware. Based on your current architecture, this should use authenticateToken middleware.</div>
                
                <div class="recommendation">
                    <strong>üí° Recommendation:</strong> To fix this JWT protection issue, add the authenticateToken middleware:

1. Import the middleware (if not already imported):
   const { authenticateToken } = require('../middleware/authenticateToken');

2. Add middleware to the route:
   router.post('/', authenticateToken, (req, res) => { ... });
   
   Or if using a controller:
   router.post('/', authenticateToken, controllerFunction);

3. For optional authentication, you can use:
   const { optionalAuth } = require('../middleware/authenticateToken');
   router.post('/', optionalAuth, (req, res) => { ... });

4. Your current JWT setup uses:
   - Access tokens (15 minutes expiry)
   - Refresh tokens (7 days expiry) 
   - Proper error handling with specific error codes

Example based on your auth.js pattern:
router.post('/', authenticateToken, controllerFunction);
                </div>
                
                <div style='margin-top: 10px; font-size: 0.9rem; color: #6c757d;'>Plugin: JWTMissingProtectionPlugin</div>
            </div>
            
            <div class="finding high">
                <div class="finding-header">
                    <div class="finding-title">Missing JWT Protection: POST /</div>
                    <span class="severity high">HIGH</span>
                </div>
                
                <div class="file-info">
                    üìÅ routes/upload.js
                     (Line 5)
                </div>
                
                <div class="description">API endpoint POST / in upload.js lacks JWT authentication middleware. Based on your current architecture, this should use authenticateToken middleware.</div>
                
                <div class="recommendation">
                    <strong>üí° Recommendation:</strong> To fix this JWT protection issue, add the authenticateToken middleware:

1. Import the middleware (if not already imported):
   const { authenticateToken } = require('../middleware/authenticateToken');

2. Add middleware to the route:
   router.post('/', authenticateToken, (req, res) => { ... });
   
   Or if using a controller:
   router.post('/', authenticateToken, controllerFunction);

3. For optional authentication, you can use:
   const { optionalAuth } = require('../middleware/authenticateToken');
   router.post('/', optionalAuth, (req, res) => { ... });

4. Your current JWT setup uses:
   - Access tokens (15 minutes expiry)
   - Refresh tokens (7 days expiry) 
   - Proper error handling with specific error codes

Example based on your auth.js pattern:
router.post('/', authenticateToken, controllerFunction);
                </div>
                
                <div style='margin-top: 10px; font-size: 0.9rem; color: #6c757d;'>Plugin: JWTMissingProtectionPlugin</div>
            </div>
            
            <div class="finding high">
                <div class="finding-header">
                    <div class="finding-title">Missing JWT Protection: POST /</div>
                    <span class="severity high">HIGH</span>
                </div>
                
                <div class="file-info">
                    üìÅ routes/waterIntake.js
                     (Line 5)
                </div>
                
                <div class="description">API endpoint POST / in waterIntake.js lacks JWT authentication middleware. Based on your current architecture, this should use authenticateToken middleware.</div>
                
                <div class="recommendation">
                    <strong>üí° Recommendation:</strong> To fix this JWT protection issue, add the authenticateToken middleware:

1. Import the middleware (if not already imported):
   const { authenticateToken } = require('../middleware/authenticateToken');

2. Add middleware to the route:
   router.post('/', authenticateToken, (req, res) => { ... });
   
   Or if using a controller:
   router.post('/', authenticateToken, controllerFunction);

3. For optional authentication, you can use:
   const { optionalAuth } = require('../middleware/authenticateToken');
   router.post('/', optionalAuth, (req, res) => { ... });

4. Your current JWT setup uses:
   - Access tokens (15 minutes expiry)
   - Refresh tokens (7 days expiry) 
   - Proper error handling with specific error codes

Example based on your auth.js pattern:
router.post('/', authenticateToken, controllerFunction);
                </div>
                
                <div style='margin-top: 10px; font-size: 0.9rem; color: #6c757d;'>Plugin: JWTMissingProtectionPlugin</div>
            </div>
            
            <div class="finding high">
                <div class="finding-header">
                    <div class="finding-title">Missing JWT Protection: POST /createRecipe</div>
                    <span class="severity high">HIGH</span>
                </div>
                
                <div class="file-info">
                    üìÅ routes/recipe.js
                     (Line 8)
                </div>
                
                <div class="description">API endpoint POST /createRecipe in recipe.js lacks JWT authentication middleware. Based on your current architecture, this should use authenticateToken middleware.</div>
                
                <div class="recommendation">
                    <strong>üí° Recommendation:</strong> To fix this JWT protection issue, add the authenticateToken middleware:

1. Import the middleware (if not already imported):
   const { authenticateToken } = require('../middleware/authenticateToken');

2. Add middleware to the route:
   router.post('/createRecipe', authenticateToken, (req, res) => { ... });
   
   Or if using a controller:
   router.post('/createRecipe', authenticateToken, controllerFunction);

3. For optional authentication, you can use:
   const { optionalAuth } = require('../middleware/authenticateToken');
   router.post('/createRecipe', optionalAuth, (req, res) => { ... });

4. Your current JWT setup uses:
   - Access tokens (15 minutes expiry)
   - Refresh tokens (7 days expiry) 
   - Proper error handling with specific error codes

Example based on your auth.js pattern:
router.post('/createRecipe', authenticateToken, controllerFunction);
                </div>
                
                <div style='margin-top: 10px; font-size: 0.9rem; color: #6c757d;'>Plugin: JWTMissingProtectionPlugin</div>
            </div>
            
            <div class="finding high">
                <div class="finding-header">
                    <div class="finding-title">Missing JWT Protection: POST /</div>
                    <span class="severity high">HIGH</span>
                </div>
                
                <div class="file-info">
                    üìÅ routes/recipe.js
                     (Line 10)
                </div>
                
                <div class="description">API endpoint POST / in recipe.js lacks JWT authentication middleware. Based on your current architecture, this should use authenticateToken middleware.</div>
                
                <div class="recommendation">
                    <strong>üí° Recommendation:</strong> To fix this JWT protection issue, add the authenticateToken middleware:

1. Import the middleware (if not already imported):
   const { authenticateToken } = require('../middleware/authenticateToken');

2. Add middleware to the route:
   router.post('/', authenticateToken, (req, res) => { ... });
   
   Or if using a controller:
   router.post('/', authenticateToken, controllerFunction);

3. For optional authentication, you can use:
   const { optionalAuth } = require('../middleware/authenticateToken');
   router.post('/', optionalAuth, (req, res) => { ... });

4. Your current JWT setup uses:
   - Access tokens (15 minutes expiry)
   - Refresh tokens (7 days expiry) 
   - Proper error handling with specific error codes

Example based on your auth.js pattern:
router.post('/', authenticateToken, controllerFunction);
                </div>
                
                <div style='margin-top: 10px; font-size: 0.9rem; color: #6c757d;'>Plugin: JWTMissingProtectionPlugin</div>
            </div>
            
            <div class="finding high">
                <div class="finding-header">
                    <div class="finding-title">Missing JWT Protection: POST /</div>
                    <span class="severity high">HIGH</span>
                </div>
                
                <div class="file-info">
                    üìÅ routes/recipe.js
                     (Line 10)
                </div>
                
                <div class="description">API endpoint POST / in recipe.js lacks JWT authentication middleware. Based on your current architecture, this should use authenticateToken middleware.</div>
                
                <div class="recommendation">
                    <strong>üí° Recommendation:</strong> To fix this JWT protection issue, add the authenticateToken middleware:

1. Import the middleware (if not already imported):
   const { authenticateToken } = require('../middleware/authenticateToken');

2. Add middleware to the route:
   router.post('/', authenticateToken, (req, res) => { ... });
   
   Or if using a controller:
   router.post('/', authenticateToken, controllerFunction);

3. For optional authentication, you can use:
   const { optionalAuth } = require('../middleware/authenticateToken');
   router.post('/', optionalAuth, (req, res) => { ... });

4. Your current JWT setup uses:
   - Access tokens (15 minutes expiry)
   - Refresh tokens (7 days expiry) 
   - Proper error handling with specific error codes

Example based on your auth.js pattern:
router.post('/', authenticateToken, controllerFunction);
                </div>
                
                <div style='margin-top: 10px; font-size: 0.9rem; color: #6c757d;'>Plugin: JWTMissingProtectionPlugin</div>
            </div>
            
            <div class="finding high">
                <div class="finding-header">
                    <div class="finding-title">Missing JWT Protection: DELETE /</div>
                    <span class="severity high">HIGH</span>
                </div>
                
                <div class="file-info">
                    üìÅ routes/recipe.js
                     (Line 11)
                </div>
                
                <div class="description">API endpoint DELETE / in recipe.js lacks JWT authentication middleware. Based on your current architecture, this should use authenticateToken middleware.</div>
                
                <div class="recommendation">
                    <strong>üí° Recommendation:</strong> To fix this JWT protection issue, add the authenticateToken middleware:

1. Import the middleware (if not already imported):
   const { authenticateToken } = require('../middleware/authenticateToken');

2. Add middleware to the route:
   router.delete('/', authenticateToken, (req, res) => { ... });
   
   Or if using a controller:
   router.delete('/', authenticateToken, controllerFunction);

3. For optional authentication, you can use:
   const { optionalAuth } = require('../middleware/authenticateToken');
   router.delete('/', optionalAuth, (req, res) => { ... });

4. Your current JWT setup uses:
   - Access tokens (15 minutes expiry)
   - Refresh tokens (7 days expiry) 
   - Proper error handling with specific error codes

Example based on your auth.js pattern:
router.delete('/', authenticateToken, controllerFunction);
                </div>
                
                <div style='margin-top: 10px; font-size: 0.9rem; color: #6c757d;'>Plugin: JWTMissingProtectionPlugin</div>
            </div>
            
            <div class="finding high">
                <div class="finding-header">
                    <div class="finding-title">Missing JWT Protection: DELETE /</div>
                    <span class="severity high">HIGH</span>
                </div>
                
                <div class="file-info">
                    üìÅ routes/recipe.js
                     (Line 11)
                </div>
                
                <div class="description">API endpoint DELETE / in recipe.js lacks JWT authentication middleware. Based on your current architecture, this should use authenticateToken middleware.</div>
                
                <div class="recommendation">
                    <strong>üí° Recommendation:</strong> To fix this JWT protection issue, add the authenticateToken middleware:

1. Import the middleware (if not already imported):
   const { authenticateToken } = require('../middleware/authenticateToken');

2. Add middleware to the route:
   router.delete('/', authenticateToken, (req, res) => { ... });
   
   Or if using a controller:
   router.delete('/', authenticateToken, controllerFunction);

3. For optional authentication, you can use:
   const { optionalAuth } = require('../middleware/authenticateToken');
   router.delete('/', optionalAuth, (req, res) => { ... });

4. Your current JWT setup uses:
   - Access tokens (15 minutes expiry)
   - Refresh tokens (7 days expiry) 
   - Proper error handling with specific error codes

Example based on your auth.js pattern:
router.delete('/', authenticateToken, controllerFunction);
                </div>
                
                <div style='margin-top: 10px; font-size: 0.9rem; color: #6c757d;'>Plugin: JWTMissingProtectionPlugin</div>
            </div>
            
            <div class="finding high">
                <div class="finding-header">
                    <div class="finding-title">Missing JWT Protection: POST /classify</div>
                    <span class="severity high">HIGH</span>
                </div>
                
                <div class="file-info">
                    üìÅ routes/routes.js
                     (Line 32)
                </div>
                
                <div class="description">API endpoint POST /classify in routes.js lacks JWT authentication middleware. Based on your current architecture, this should use authenticateToken middleware.</div>
                
                <div class="recommendation">
                    <strong>üí° Recommendation:</strong> To fix this JWT protection issue, add the authenticateToken middleware:

1. Import the middleware (if not already imported):
   const { authenticateToken } = require('../middleware/authenticateToken');

2. Add middleware to the route:
   router.post('/classify', authenticateToken, (req, res) => { ... });
   
   Or if using a controller:
   router.post('/classify', authenticateToken, controllerFunction);

3. For optional authentication, you can use:
   const { optionalAuth } = require('../middleware/authenticateToken');
   router.post('/classify', optionalAuth, (req, res) => { ... });

4. Your current JWT setup uses:
   - Access tokens (15 minutes expiry)
   - Refresh tokens (7 days expiry) 
   - Proper error handling with specific error codes

Example based on your auth.js pattern:
router.post('/classify', authenticateToken, controllerFunction);
                </div>
                
                <div style='margin-top: 10px; font-size: 0.9rem; color: #6c757d;'>Plugin: JWTMissingProtectionPlugin</div>
            </div>
            
            <div class="finding high">
                <div class="finding-header">
                    <div class="finding-title">Missing JWT Protection: POST /</div>
                    <span class="severity high">HIGH</span>
                </div>
                
                <div class="file-info">
                    üìÅ routes/userfeedback.js
                     (Line 8)
                </div>
                
                <div class="description">API endpoint POST / in userfeedback.js lacks JWT authentication middleware. Based on your current architecture, this should use authenticateToken middleware.</div>
                
                <div class="recommendation">
                    <strong>üí° Recommendation:</strong> To fix this JWT protection issue, add the authenticateToken middleware:

1. Import the middleware (if not already imported):
   const { authenticateToken } = require('../middleware/authenticateToken');

2. Add middleware to the route:
   router.post('/', authenticateToken, (req, res) => { ... });
   
   Or if using a controller:
   router.post('/', authenticateToken, controllerFunction);

3. For optional authentication, you can use:
   const { optionalAuth } = require('../middleware/authenticateToken');
   router.post('/', optionalAuth, (req, res) => { ... });

4. Your current JWT setup uses:
   - Access tokens (15 minutes expiry)
   - Refresh tokens (7 days expiry) 
   - Proper error handling with specific error codes

Example based on your auth.js pattern:
router.post('/', authenticateToken, controllerFunction);
                </div>
                
                <div style='margin-top: 10px; font-size: 0.9rem; color: #6c757d;'>Plugin: JWTMissingProtectionPlugin</div>
            </div>
            
            <div class="finding high">
                <div class="finding-header">
                    <div class="finding-title">Missing JWT Protection: POST /</div>
                    <span class="severity high">HIGH</span>
                </div>
                
                <div class="file-info">
                    üìÅ routes/healthNews.js
                     (Line 156)
                </div>
                
                <div class="description">API endpoint POST / in healthNews.js lacks JWT authentication middleware. Based on your current architecture, this should use authenticateToken middleware.</div>
                
                <div class="recommendation">
                    <strong>üí° Recommendation:</strong> To fix this JWT protection issue, add the authenticateToken middleware:

1. Import the middleware (if not already imported):
   const { authenticateToken } = require('../middleware/authenticateToken');

2. Add middleware to the route:
   router.post('/', authenticateToken, (req, res) => { ... });
   
   Or if using a controller:
   router.post('/', authenticateToken, controllerFunction);

3. For optional authentication, you can use:
   const { optionalAuth } = require('../middleware/authenticateToken');
   router.post('/', optionalAuth, (req, res) => { ... });

4. Your current JWT setup uses:
   - Access tokens (15 minutes expiry)
   - Refresh tokens (7 days expiry) 
   - Proper error handling with specific error codes

Example based on your auth.js pattern:
router.post('/', authenticateToken, controllerFunction);
                </div>
                
                <div style='margin-top: 10px; font-size: 0.9rem; color: #6c757d;'>Plugin: JWTMissingProtectionPlugin</div>
            </div>
            
            <div class="finding high">
                <div class="finding-header">
                    <div class="finding-title">Missing JWT Protection: PUT /</div>
                    <span class="severity high">HIGH</span>
                </div>
                
                <div class="file-info">
                    üìÅ routes/healthNews.js
                     (Line 214)
                </div>
                
                <div class="description">API endpoint PUT / in healthNews.js lacks JWT authentication middleware. Based on your current architecture, this should use authenticateToken middleware.</div>
                
                <div class="recommendation">
                    <strong>üí° Recommendation:</strong> To fix this JWT protection issue, add the authenticateToken middleware:

1. Import the middleware (if not already imported):
   const { authenticateToken } = require('../middleware/authenticateToken');

2. Add middleware to the route:
   router.put('/', authenticateToken, (req, res) => { ... });
   
   Or if using a controller:
   router.put('/', authenticateToken, controllerFunction);

3. For optional authentication, you can use:
   const { optionalAuth } = require('../middleware/authenticateToken');
   router.put('/', optionalAuth, (req, res) => { ... });

4. Your current JWT setup uses:
   - Access tokens (15 minutes expiry)
   - Refresh tokens (7 days expiry) 
   - Proper error handling with specific error codes

Example based on your auth.js pattern:
router.put('/', authenticateToken, controllerFunction);
                </div>
                
                <div style='margin-top: 10px; font-size: 0.9rem; color: #6c757d;'>Plugin: JWTMissingProtectionPlugin</div>
            </div>
            
            <div class="finding high">
                <div class="finding-header">
                    <div class="finding-title">Missing JWT Protection: DELETE /</div>
                    <span class="severity high">HIGH</span>
                </div>
                
                <div class="file-info">
                    üìÅ routes/healthNews.js
                     (Line 238)
                </div>
                
                <div class="description">API endpoint DELETE / in healthNews.js lacks JWT authentication middleware. Based on your current architecture, this should use authenticateToken middleware.</div>
                
                <div class="recommendation">
                    <strong>üí° Recommendation:</strong> To fix this JWT protection issue, add the authenticateToken middleware:

1. Import the middleware (if not already imported):
   const { authenticateToken } = require('../middleware/authenticateToken');

2. Add middleware to the route:
   router.delete('/', authenticateToken, (req, res) => { ... });
   
   Or if using a controller:
   router.delete('/', authenticateToken, controllerFunction);

3. For optional authentication, you can use:
   const { optionalAuth } = require('../middleware/authenticateToken');
   router.delete('/', optionalAuth, (req, res) => { ... });

4. Your current JWT setup uses:
   - Access tokens (15 minutes expiry)
   - Refresh tokens (7 days expiry) 
   - Proper error handling with specific error codes

Example based on your auth.js pattern:
router.delete('/', authenticateToken, controllerFunction);
                </div>
                
                <div style='margin-top: 10px; font-size: 0.9rem; color: #6c757d;'>Plugin: JWTMissingProtectionPlugin</div>
            </div>
            
            <div class="finding high">
                <div class="finding-header">
                    <div class="finding-title">Missing JWT Protection: POST /generate-baseline</div>
                    <span class="severity high">HIGH</span>
                </div>
                
                <div class="file-info">
                    üìÅ routes/systemRoutes.js
                     (Line 50)
                </div>
                
                <div class="description">API endpoint POST /generate-baseline in systemRoutes.js lacks JWT authentication middleware. Based on your current architecture, this should use authenticateToken middleware.</div>
                
                <div class="recommendation">
                    <strong>üí° Recommendation:</strong> To fix this JWT protection issue, add the authenticateToken middleware:

1. Import the middleware (if not already imported):
   const { authenticateToken } = require('../middleware/authenticateToken');

2. Add middleware to the route:
   router.post('/generate-baseline', authenticateToken, (req, res) => { ... });
   
   Or if using a controller:
   router.post('/generate-baseline', authenticateToken, controllerFunction);

3. For optional authentication, you can use:
   const { optionalAuth } = require('../middleware/authenticateToken');
   router.post('/generate-baseline', optionalAuth, (req, res) => { ... });

4. Your current JWT setup uses:
   - Access tokens (15 minutes expiry)
   - Refresh tokens (7 days expiry) 
   - Proper error handling with specific error codes

Example based on your auth.js pattern:
router.post('/generate-baseline', authenticateToken, controllerFunction);
                </div>
                
                <div style='margin-top: 10px; font-size: 0.9rem; color: #6c757d;'>Plugin: JWTMissingProtectionPlugin</div>
            </div>
            
            <div class="finding high">
                <div class="finding-header">
                    <div class="finding-title">Missing JWT Protection: POST /</div>
                    <span class="severity high">HIGH</span>
                </div>
                
                <div class="file-info">
                    üìÅ routes/contactus.js
                     (Line 14)
                </div>
                
                <div class="description">API endpoint POST / in contactus.js lacks JWT authentication middleware. Based on your current architecture, this should use authenticateToken middleware.</div>
                
                <div class="recommendation">
                    <strong>üí° Recommendation:</strong> To fix this JWT protection issue, add the authenticateToken middleware:

1. Import the middleware (if not already imported):
   const { authenticateToken } = require('../middleware/authenticateToken');

2. Add middleware to the route:
   router.post('/', authenticateToken, (req, res) => { ... });
   
   Or if using a controller:
   router.post('/', authenticateToken, controllerFunction);

3. For optional authentication, you can use:
   const { optionalAuth } = require('../middleware/authenticateToken');
   router.post('/', optionalAuth, (req, res) => { ... });

4. Your current JWT setup uses:
   - Access tokens (15 minutes expiry)
   - Refresh tokens (7 days expiry) 
   - Proper error handling with specific error codes

Example based on your auth.js pattern:
router.post('/', authenticateToken, controllerFunction);
                </div>
                
                <div style='margin-top: 10px; font-size: 0.9rem; color: #6c757d;'>Plugin: JWTMissingProtectionPlugin</div>
            </div>
            
            <div class="finding medium">
                <div class="finding-header">
                    <div class="finding-title">Missing JWT Protection: GET /</div>
                    <span class="severity medium">MEDIUM</span>
                </div>
                
                <div class="file-info">
                    üìÅ routes/recipeNutritionlog.js
                     (Line 27)
                </div>
                
                <div class="description">API endpoint GET / in recipeNutritionlog.js lacks JWT authentication middleware. Based on your current architecture, this should use authenticateToken middleware.</div>
                
                <div class="recommendation">
                    <strong>üí° Recommendation:</strong> To fix this JWT protection issue, add the authenticateToken middleware:

1. Import the middleware (if not already imported):
   const { authenticateToken } = require('../middleware/authenticateToken');

2. Add middleware to the route:
   router.get('/', authenticateToken, (req, res) => { ... });
   
   Or if using a controller:
   router.get('/', authenticateToken, controllerFunction);

3. For optional authentication, you can use:
   const { optionalAuth } = require('../middleware/authenticateToken');
   router.get('/', optionalAuth, (req, res) => { ... });

4. Your current JWT setup uses:
   - Access tokens (15 minutes expiry)
   - Refresh tokens (7 days expiry) 
   - Proper error handling with specific error codes

Example based on your auth.js pattern:
router.get('/', authenticateToken, controllerFunction);
                </div>
                
                <div style='margin-top: 10px; font-size: 0.9rem; color: #6c757d;'>Plugin: JWTMissingProtectionPlugin</div>
            </div>
            
            <div class="finding medium">
                <div class="finding-header">
                    <div class="finding-title">Missing JWT Protection: GET /</div>
                    <span class="severity medium">MEDIUM</span>
                </div>
                
                <div class="file-info">
                    üìÅ routes/healthNews.js
                     (Line 44)
                </div>
                
                <div class="description">API endpoint GET / in healthNews.js lacks JWT authentication middleware. Based on your current architecture, this should use authenticateToken middleware.</div>
                
                <div class="recommendation">
                    <strong>üí° Recommendation:</strong> To fix this JWT protection issue, add the authenticateToken middleware:

1. Import the middleware (if not already imported):
   const { authenticateToken } = require('../middleware/authenticateToken');

2. Add middleware to the route:
   router.get('/', authenticateToken, (req, res) => { ... });
   
   Or if using a controller:
   router.get('/', authenticateToken, controllerFunction);

3. For optional authentication, you can use:
   const { optionalAuth } = require('../middleware/authenticateToken');
   router.get('/', optionalAuth, (req, res) => { ... });

4. Your current JWT setup uses:
   - Access tokens (15 minutes expiry)
   - Refresh tokens (7 days expiry) 
   - Proper error handling with specific error codes

Example based on your auth.js pattern:
router.get('/', authenticateToken, controllerFunction);
                </div>
                
                <div style='margin-top: 10px; font-size: 0.9rem; color: #6c757d;'>Plugin: JWTMissingProtectionPlugin</div>
            </div>
            
            <div class="finding medium">
                <div class="finding-header">
                    <div class="finding-title">Missing JWT Protection: GET /integrity-check</div>
                    <span class="severity medium">MEDIUM</span>
                </div>
                
                <div class="file-info">
                    üìÅ routes/systemRoutes.js
                     (Line 59)
                </div>
                
                <div class="description">API endpoint GET /integrity-check in systemRoutes.js lacks JWT authentication middleware. Based on your current architecture, this should use authenticateToken middleware.</div>
                
                <div class="recommendation">
                    <strong>üí° Recommendation:</strong> To fix this JWT protection issue, add the authenticateToken middleware:

1. Import the middleware (if not already imported):
   const { authenticateToken } = require('../middleware/authenticateToken');

2. Add middleware to the route:
   router.get('/integrity-check', authenticateToken, (req, res) => { ... });
   
   Or if using a controller:
   router.get('/integrity-check', authenticateToken, controllerFunction);

3. For optional authentication, you can use:
   const { optionalAuth } = require('../middleware/authenticateToken');
   router.get('/integrity-check', optionalAuth, (req, res) => { ... });

4. Your current JWT setup uses:
   - Access tokens (15 minutes expiry)
   - Refresh tokens (7 days expiry) 
   - Proper error handling with specific error codes

Example based on your auth.js pattern:
router.get('/integrity-check', authenticateToken, controllerFunction);
                </div>
                
                <div style='margin-top: 10px; font-size: 0.9rem; color: #6c757d;'>Plugin: JWTMissingProtectionPlugin</div>
            </div>
            
            <div class="finding medium">
                <div class="finding-header">
                    <div class="finding-title">Missing JWT Protection: GET /</div>
                    <span class="severity medium">MEDIUM</span>
                </div>
                
                <div class="file-info">
                    üìÅ routes/filter.js
                     (Line 7)
                </div>
                
                <div class="description">API endpoint GET / in filter.js lacks JWT authentication middleware. Based on your current architecture, this should use authenticateToken middleware.</div>
                
                <div class="recommendation">
                    <strong>üí° Recommendation:</strong> To fix this JWT protection issue, add the authenticateToken middleware:

1. Import the middleware (if not already imported):
   const { authenticateToken } = require('../middleware/authenticateToken');

2. Add middleware to the route:
   router.get('/', authenticateToken, (req, res) => { ... });
   
   Or if using a controller:
   router.get('/', authenticateToken, controllerFunction);

3. For optional authentication, you can use:
   const { optionalAuth } = require('../middleware/authenticateToken');
   router.get('/', optionalAuth, (req, res) => { ... });

4. Your current JWT setup uses:
   - Access tokens (15 minutes expiry)
   - Refresh tokens (7 days expiry) 
   - Proper error handling with specific error codes

Example based on your auth.js pattern:
router.get('/', authenticateToken, controllerFunction);
                </div>
                
                <div style='margin-top: 10px; font-size: 0.9rem; color: #6c757d;'>Plugin: JWTMissingProtectionPlugin</div>
            </div>
            
            <div class="finding medium">
                <div class="finding-header">
                    <div class="finding-title">Missing JWT Protection: GET /</div>
                    <span class="severity medium">MEDIUM</span>
                </div>
                
                <div class="file-info">
                    üìÅ routes/articles.js
                     (Line 5)
                </div>
                
                <div class="description">API endpoint GET / in articles.js lacks JWT authentication middleware. Based on your current architecture, this should use authenticateToken middleware.</div>
                
                <div class="recommendation">
                    <strong>üí° Recommendation:</strong> To fix this JWT protection issue, add the authenticateToken middleware:

1. Import the middleware (if not already imported):
   const { authenticateToken } = require('../middleware/authenticateToken');

2. Add middleware to the route:
   router.get('/', authenticateToken, (req, res) => { ... });
   
   Or if using a controller:
   router.get('/', authenticateToken, controllerFunction);

3. For optional authentication, you can use:
   const { optionalAuth } = require('../middleware/authenticateToken');
   router.get('/', optionalAuth, (req, res) => { ... });

4. Your current JWT setup uses:
   - Access tokens (15 minutes expiry)
   - Refresh tokens (7 days expiry) 
   - Proper error handling with specific error codes

Example based on your auth.js pattern:
router.get('/', authenticateToken, controllerFunction);
                </div>
                
                <div style='margin-top: 10px; font-size: 0.9rem; color: #6c757d;'>Plugin: JWTMissingProtectionPlugin</div>
            </div>
            
            <div class="finding medium">
                <div class="finding-header">
                    <div class="finding-title">Missing JWT Protection: GET /:user_id</div>
                    <span class="severity medium">MEDIUM</span>
                </div>
                
                <div class="file-info">
                    üìÅ routes/notifications.js
                     (Line 21)
                </div>
                
                <div class="description">API endpoint GET /:user_id in notifications.js lacks JWT authentication middleware. Based on your current architecture, this should use authenticateToken middleware.</div>
                
                <div class="recommendation">
                    <strong>üí° Recommendation:</strong> To fix this JWT protection issue, add the authenticateToken middleware:

1. Import the middleware (if not already imported):
   const { authenticateToken } = require('../middleware/authenticateToken');

2. Add middleware to the route:
   router.get('/:user_id', authenticateToken, (req, res) => { ... });
   
   Or if using a controller:
   router.get('/:user_id', authenticateToken, controllerFunction);

3. For optional authentication, you can use:
   const { optionalAuth } = require('../middleware/authenticateToken');
   router.get('/:user_id', optionalAuth, (req, res) => { ... });

4. Your current JWT setup uses:
   - Access tokens (15 minutes expiry)
   - Refresh tokens (7 days expiry) 
   - Proper error handling with specific error codes

Example based on your auth.js pattern:
router.get('/:user_id', authenticateToken, controllerFunction);
                </div>
                
                <div style='margin-top: 10px; font-size: 0.9rem; color: #6c757d;'>Plugin: JWTMissingProtectionPlugin</div>
            </div>
            
            <div class="finding medium">
                <div class="finding-header">
                    <div class="finding-title">Missing JWT Protection: GET /:user_id</div>
                    <span class="severity medium">MEDIUM</span>
                </div>
                
                <div class="file-info">
                    üìÅ routes/notifications.js
                     (Line 21)
                </div>
                
                <div class="description">API endpoint GET /:user_id in notifications.js lacks JWT authentication middleware. Based on your current architecture, this should use authenticateToken middleware.</div>
                
                <div class="recommendation">
                    <strong>üí° Recommendation:</strong> To fix this JWT protection issue, add the authenticateToken middleware:

1. Import the middleware (if not already imported):
   const { authenticateToken } = require('../middleware/authenticateToken');

2. Add middleware to the route:
   router.get('/:user_id', authenticateToken, (req, res) => { ... });
   
   Or if using a controller:
   router.get('/:user_id', authenticateToken, controllerFunction);

3. For optional authentication, you can use:
   const { optionalAuth } = require('../middleware/authenticateToken');
   router.get('/:user_id', optionalAuth, (req, res) => { ... });

4. Your current JWT setup uses:
   - Access tokens (15 minutes expiry)
   - Refresh tokens (7 days expiry) 
   - Proper error handling with specific error codes

Example based on your auth.js pattern:
router.get('/:user_id', authenticateToken, controllerFunction);
                </div>
                
                <div style='margin-top: 10px; font-size: 0.9rem; color: #6c757d;'>Plugin: JWTMissingProtectionPlugin</div>
            </div>
            
            <div class="finding medium">
                <div class="finding-header">
                    <div class="finding-title">Low Entropy JWT Secret</div>
                    <span class="severity medium">MEDIUM</span>
                </div>
                
                <div class="file-info">
                    üìÅ .env
                     (Line 10)
                </div>
                
                <div class="description">JWT secret appears to have low entropy (predictable patterns). This could make the secret easier to guess.</div>
                
                <div class="recommendation">
                    <strong>üí° Recommendation:</strong> Use cryptographically secure random generation for JWT secrets.
                </div>
                
                <div style='margin-top: 10px; font-size: 0.9rem; color: #6c757d;'>Plugin: JWTConfigurationPlugin</div>
            </div>
            
            <div class="finding medium">
                <div class="finding-header">
                    <div class="finding-title">Direct JWT Usage Instead of AuthService</div>
                    <span class="severity medium">MEDIUM</span>
                </div>
                
                <div class="file-info">
                    üìÅ middleware.js
                    
                </div>
                
                <div class="description">File middleware.js uses direct jwt.verify() instead of the centralized authService. This bypasses your unified authentication logic.</div>
                
                <div class="recommendation">
                    <strong>üí° Recommendation:</strong> Consider updating this file to use authService.verifyAccessToken() for consistent authentication behavior.
                </div>
                
                <div style='margin-top: 10px; font-size: 0.9rem; color: #6c757d;'>Plugin: JWTConfigurationPlugin</div>
            </div>
            
            <div class="finding medium">
                <div class="finding-header">
                    <div class="finding-title">Multiple JWT Implementation Files Detected</div>
                    <span class="severity medium">MEDIUM</span>
                </div>
                
                <div class="file-info">
                    üìÅ Multiple files
                    
                </div>
                
                <div class="description">Found 2 different JWT middleware files: middleware.js, authenticateToken.js. This could lead to inconsistent authentication behavior.</div>
                
                <div class="recommendation">
                    <strong>üí° Recommendation:</strong> Consider consolidating to a single JWT middleware implementation to avoid confusion and ensure consistent behavior.
                </div>
                
                <div style='margin-top: 10px; font-size: 0.9rem; color: #6c757d;'>Plugin: JWTConfigurationPlugin</div>
            </div>
            
            <div class="finding low">
                <div class="finding-header">
                    <div class="finding-title">Incomplete JWT Error Handling</div>
                    <span class="severity low">LOW</span>
                </div>
                
                <div class="file-info">
                    üìÅ middleware.js
                    
                </div>
                
                <div class="description">JWT verification code lacks comprehensive error handling. Should handle TokenExpiredError, JsonWebTokenError, and other JWT-related errors.</div>
                
                <div class="recommendation">
                    <strong>üí° Recommendation:</strong> Add comprehensive error handling for different JWT error types to provide better user experience and security.
                </div>
                
                <div style='margin-top: 10px; font-size: 0.9rem; color: #6c757d;'>Plugin: JWTConfigurationPlugin</div>
            </div>
            
            </div>
            
            <div class="footer">
                <p>Generated by <strong>NutriHelp Security Scanner V2.0</strong></p>
                <p>For support, visit our documentation or contact the development team</p>
            </div>
        </div>
    </body>
    </html>
    